
<astro>
    // Importa el módulo de Astro necesario
    import type { APIRoute } from "astro";
  
    // Define la ruta del endpoint POST
    export const POST: APIRoute = async ({ request }) => {
      try {
        // Recibe los datos del formulario
        const data = await request.formData();
        const first_name = data.get("first_name");
        const last_name = data.get("last_name");
        const email = data.get("email");
        const password = data.get("password");
  
        // Validación de los datos
        if (!first_name || !last_name || !email || !password) {
          return new Response(
            JSON.stringify({
              message: "Missing required fields",
            }),
            { status: 400 }
          );
        }
  
        // Envía los datos a tu API de autenticación
        const response = await fetch('http://localhost:8000/authenticate', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
          },
          body: JSON.stringify({
            first_name,
            last_name,
            email,
            password
          }),
        });
  
        if (!response.ok) {
          throw new Error('Network response was not ok');
        }
  
        const responseData = await response.json();
        
        // Retorna una respuesta exitosa
        return new Response(
          JSON.stringify({
            message: "Success!",
            responseData // Opcionalmente, puedes retornar datos desde tu API de autenticación
          }),
          { status: 200 }
        );
      } catch (error) {
        console.error('There was an error!', error);
        // Retorna una respuesta de error
        return new Response(
          JSON.stringify({
            message: "There was an error processing your request",
          }),
          { status: 500 }
        );
      }
    };
  </astro>